---
title: "decal-midterm"
author: "Krista Waugh"
date: "3/6/2019"
output: html_document
---
```{r}
library(readr)
library(ggplot2)
library(plyr)
library(dplyr)
library(tidyverse)
library(ggbiplot)
library(kimisc)
```


```{r}

data0<- read_csv("decal_midterm.csv")
colnames(data0) = c("claim_number", "age", "income", "marital_status", "education", "mvr_points", "car_age", "location", "old_claim", "premium")
data0$income2 = as.numeric(gsub("[\\$,]", "", data0$income))
data0$old_claim2 = as.numeric(gsub("[\\$-,]", "", data0$old_claim))
data0
```

```{r}
pca_data <-  select(data0, age, income2, mvr_points, old_claim2, car_age, education, location, marital_status)
pca_data$old_claim2[is.na(pca_data$old_claim2)] <- 0
pca_data$income2[is.na(pca_data$income2)] <- 0
pca_data
```
```{r}
sample_pca_data <- pca_data[sample(nrow(pca_data), 200), ]
sample_pca_data
```


```{r}
auto_pca <- prcomp(sample_pca_data[c(1:5)], center = TRUE, scale. = TRUE)
auto_pca
```


```{r}
summary(auto_pca)
```

```{r}
str(auto_pca)
```

```{r}
#This doesnt make sense because the location isnt factored into auto_pca ???? 


auto_pca_marital_status <- c(rep("Yes"), rep("No"))

auto_pca_location <- c(rep("Highly Urban/ Urban"), rep("Highly Rural/ Rural"))

ggbiplot(auto_pca, ellipse = TRUE, groups = auto_pca_location)
```




```{r}

age <- select(sample_pca_data, age, mvr_points)
age

ggplot(age, aes(age, mvr_points)) + geom_point()
```













